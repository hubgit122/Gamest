!function(a){"use strict";a.fn.popup=function(a){return new c(this[0],a)};var b=[],c=function(){var c=function(c,d){if(this.container="string"==typeof c||c instanceof String?document.getElementById(c):c,!this.container)return window.alert("Error finding container for popup "+c),void 0;try{("string"==typeof d||"number"==typeof d)&&(d={message:d,cancelOnly:"true",cancelText:"OK"}),this.id=d.id=d.id||a.uuid(),this.addCssClass=d.addCssClass?d.addCssClass:"",this.title=d.suppressTitle?"":d.title||"Alert",this.message=d.message||"",this.cancelText=d.cancelText||"Cancel",this.cancelCallback=d.cancelCallback||function(){},this.cancelClass=d.cancelClass||"button",this.doneText=d.doneText||"Done",this.doneCallback=d.doneCallback||function(){},this.doneClass=d.doneClass||"button",this.cancelOnly=d.cancelOnly||!1,this.onShow=d.onShow||function(){},this.autoCloseDone=void 0!==d.autoCloseDone?d.autoCloseDone:!0,b.push(this),1===b.length&&this.show()}catch(e){console.log("error adding popup "+e)}};return c.prototype={id:null,addCssClass:null,title:null,message:null,cancelText:null,cancelCallback:null,cancelClass:null,doneText:null,doneCallback:null,doneClass:null,cancelOnly:!1,onShow:null,autoCloseDone:!0,supressTitle:!1,show:function(){var b=this,c="<div id='"+this.id+"' class='afPopup hidden "+this.addCssClass+"'>"+"<header>"+this.title+"</header>"+"<div>"+this.message+"</div>"+"<footer>"+"<a href='javascript:;' class='"+this.cancelClass+"' id='cancel'>"+this.cancelText+"</a>"+"<a href='javascript:;' class='"+this.doneClass+"' id='action'>"+this.doneText+"</a>"+"<div style='clear:both'></div>"+"</footer>"+"</div>";a(this.container).append(a(c));var d=a.query("#"+this.id);d.bind("close",function(){b.hide()}),this.cancelOnly&&(d.find("A#action").hide(),d.find("A#cancel").addClass("center")),d.find("A").each(function(){var c=a(this);c.bind("click",function(a){"cancel"===c.attr("id")?(b.cancelCallback.call(b.cancelCallback,b),b.hide()):(b.doneCallback.call(b.doneCallback,b),b.autoCloseDone&&b.hide()),a.preventDefault()})}),b.positionPopup(),a.blockUI(.5),d.bind("orientationchange",function(){b.positionPopup()}),d.find("header").show(),d.find("footer").show(),setTimeout(function(){d.removeClass("hidden"),b.onShow(b)},50)},hide:function(){var b=this;a.query("#"+b.id).addClass("hidden"),a.unblockUI(),a.os.ie||a.os.android?b.remove():setTimeout(function(){b.remove()},250)},remove:function(){var c=this,d=a.query("#"+c.id);d.unbind("close"),d.find("BUTTON#action").unbind("click"),d.find("BUTTON#cancel").unbind("click"),d.unbind("orientationchange").remove(),b.splice(0,1),b.length>0&&b[0].show()},positionPopup:function(){var b=a.query("#"+this.id);b.css("top",window.innerHeight/2.5+window.pageYOffset-b[0].clientHeight/2+"px"),b.css("left",window.innerWidth/2-b[0].clientWidth/2+"px")}},c}(),d=!1;a.blockUI=function(b){d||(b=b?" style='opacity:"+b+";'":"",a.query("BODY").prepend(a("<div id='mask'"+b+"></div>")),a.query("BODY DIV#mask").bind("touchstart",function(a){a.preventDefault()}),a.query("BODY DIV#mask").bind("touchmove",function(a){a.preventDefault()}),d=!0)},a.unblockUI=function(){d=!1,a.query("BODY DIV#mask").unbind("touchstart"),a.query("BODY DIV#mask").unbind("touchmove"),a("BODY DIV#mask").remove()}}(af);